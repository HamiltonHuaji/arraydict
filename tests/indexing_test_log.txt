====================================================================================================
ArrayDict Advanced Indexing Test Log
====================================================================================================

Initial ArrayDict:
ad = ArrayDict(
    fields={
        ('nested', 'a'): shape=(10, 8, 4),
        ('nested', 'b'): shape=(10, 8, 2, 3),
        ('tuple', 'key'): shape=(10, 8, 7),
        ('x',): shape=(10, 8, 5),
        ('y',): shape=(10, 8, 3, 2),
        ('z',): shape=(10, 8),
    },
    batch_size=(10, 8))

Single Index Tests:
----------------------------------------------------------------------------------------------------
ad[0] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(8, 4),
            ('nested', 'b'): shape=(8, 2, 3),
            ('tuple', 'key'): shape=(8, 7),
            ('x',): shape=(8, 5),
            ('y',): shape=(8, 3, 2),
            ('z',): shape=(8,),
        },
        batch_size=(8,))

ad[-1] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(8, 4),
            ('nested', 'b'): shape=(8, 2, 3),
            ('tuple', 'key'): shape=(8, 7),
            ('x',): shape=(8, 5),
            ('y',): shape=(8, 3, 2),
            ('z',): shape=(8,),
        },
        batch_size=(8,))

ad[1:5] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(4, 8, 4),
            ('nested', 'b'): shape=(4, 8, 2, 3),
            ('tuple', 'key'): shape=(4, 8, 7),
            ('x',): shape=(4, 8, 5),
            ('y',): shape=(4, 8, 3, 2),
            ('z',): shape=(4, 8),
        },
        batch_size=(4, 8))

ad[::2] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(5, 8, 4),
            ('nested', 'b'): shape=(5, 8, 2, 3),
            ('tuple', 'key'): shape=(5, 8, 7),
            ('x',): shape=(5, 8, 5),
            ('y',): shape=(5, 8, 3, 2),
            ('z',): shape=(5, 8),
        },
        batch_size=(5, 8))

ad[None] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 10, 8, 4),
            ('nested', 'b'): shape=(1, 10, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 10, 8, 7),
            ('x',): shape=(1, 10, 8, 5),
            ('y',): shape=(1, 10, 8, 3, 2),
            ('z',): shape=(1, 10, 8),
        },
        batch_size=(1, 10, 8))

ad[...] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(10, 8, 4),
            ('nested', 'b'): shape=(10, 8, 2, 3),
            ('tuple', 'key'): shape=(10, 8, 7),
            ('x',): shape=(10, 8, 5),
            ('y',): shape=(10, 8, 3, 2),
            ('z',): shape=(10, 8),
        },
        batch_size=(10, 8))

ad[jnp.array([0, 2, 4, 6])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(4, 8, 4),
            ('nested', 'b'): shape=(4, 8, 2, 3),
            ('tuple', 'key'): shape=(4, 8, 7),
            ('x',): shape=(4, 8, 5),
            ('y',): shape=(4, 8, 3, 2),
            ('z',): shape=(4, 8),
        },
        batch_size=(4, 8))

ad[jnp.array(shape=(10,), dtype=bool)] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(6, 8, 4),
            ('nested', 'b'): shape=(6, 8, 2, 3),
            ('tuple', 'key'): shape=(6, 8, 7),
            ('x',): shape=(6, 8, 5),
            ('y',): shape=(6, 8, 3, 2),
            ('z',): shape=(6, 8),
        },
        batch_size=(6, 8))

ad[2, 3] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(4,),
            ('nested', 'b'): shape=(2, 3),
            ('tuple', 'key'): shape=(7,),
            ('x',): shape=(5,),
            ('y',): shape=(3, 2),
            ('z',): shape=(),
        },
        batch_size=())

ad[1:4, 2] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(3, 4),
            ('nested', 'b'): shape=(3, 2, 3),
            ('tuple', 'key'): shape=(3, 7),
            ('x',): shape=(3, 5),
            ('y',): shape=(3, 3, 2),
            ('z',): shape=(3,),
        },
        batch_size=(3,))

ad[None, 2:6, ...] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 4, 8, 4),
            ('nested', 'b'): shape=(1, 4, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 4, 8, 7),
            ('x',): shape=(1, 4, 8, 5),
            ('y',): shape=(1, 4, 8, 3, 2),
            ('z',): shape=(1, 4, 8),
        },
        batch_size=(1, 4, 8))

Column Selection Tests:
----------------------------------------------------------------------------------------------------
ad['x']
    → shape=(10, 8, 5), dtype=float32

ad['z']
    → shape=(10, 8), dtype=float32

ad[('tuple', 'key')]
    → shape=(10, 8, 7), dtype=float32

ad[('nested', 'a')]
    → shape=(10, 8, 4), dtype=float32

ad['nested'] ==
    ArrayDict(
        fields={
            ('a',): shape=(10, 8, 4),
            ('b',): shape=(10, 8, 2, 3),
        },
        batch_size=(10, 8))

Random Combination Tests:
----------------------------------------------------------------------------------------------------
ad[jnp.array([9])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 8, 4),
            ('nested', 'b'): shape=(1, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 8, 7),
            ('x',): shape=(1, 8, 5),
            ('y',): shape=(1, 8, 3, 2),
            ('z',): shape=(1, 8),
        },
        batch_size=(1, 8))

ad[jnp.array([2, 8, 6])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(3, 8, 4),
            ('nested', 'b'): shape=(3, 8, 2, 3),
            ('tuple', 'key'): shape=(3, 8, 7),
            ('x',): shape=(3, 8, 5),
            ('y',): shape=(3, 8, 3, 2),
            ('z',): shape=(3, 8),
        },
        batch_size=(3, 8))

ad[jnp.array([7])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 8, 4),
            ('nested', 'b'): shape=(1, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 8, 7),
            ('x',): shape=(1, 8, 5),
            ('y',): shape=(1, 8, 3, 2),
            ('z',): shape=(1, 8),
        },
        batch_size=(1, 8))

ad[0] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(8, 4),
            ('nested', 'b'): shape=(8, 2, 3),
            ('tuple', 'key'): shape=(8, 7),
            ('x',): shape=(8, 5),
            ('y',): shape=(8, 3, 2),
            ('z',): shape=(8,),
        },
        batch_size=(8,))

ad[3:6] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(3, 8, 4),
            ('nested', 'b'): shape=(3, 8, 2, 3),
            ('tuple', 'key'): shape=(3, 8, 7),
            ('x',): shape=(3, 8, 5),
            ('y',): shape=(3, 8, 3, 2),
            ('z',): shape=(3, 8),
        },
        batch_size=(3, 8))

ad[5] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(8, 4),
            ('nested', 'b'): shape=(8, 2, 3),
            ('tuple', 'key'): shape=(8, 7),
            ('x',): shape=(8, 5),
            ('y',): shape=(8, 3, 2),
            ('z',): shape=(8,),
        },
        batch_size=(8,))

ad[None] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 10, 8, 4),
            ('nested', 'b'): shape=(1, 10, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 10, 8, 7),
            ('x',): shape=(1, 10, 8, 5),
            ('y',): shape=(1, 10, 8, 3, 2),
            ('z',): shape=(1, 10, 8),
        },
        batch_size=(1, 10, 8))

ad[0:1] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 8, 4),
            ('nested', 'b'): shape=(1, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 8, 7),
            ('x',): shape=(1, 8, 5),
            ('y',): shape=(1, 8, 3, 2),
            ('z',): shape=(1, 8),
        },
        batch_size=(1, 8))

ad[jnp.array([2, 4, 8])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(3, 8, 4),
            ('nested', 'b'): shape=(3, 8, 2, 3),
            ('tuple', 'key'): shape=(3, 8, 7),
            ('x',): shape=(3, 8, 5),
            ('y',): shape=(3, 8, 3, 2),
            ('z',): shape=(3, 8),
        },
        batch_size=(3, 8))

ad[...] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(10, 8, 4),
            ('nested', 'b'): shape=(10, 8, 2, 3),
            ('tuple', 'key'): shape=(10, 8, 7),
            ('x',): shape=(10, 8, 5),
            ('y',): shape=(10, 8, 3, 2),
            ('z',): shape=(10, 8),
        },
        batch_size=(10, 8))

ad[jnp.array([3])] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(1, 8, 4),
            ('nested', 'b'): shape=(1, 8, 2, 3),
            ('tuple', 'key'): shape=(1, 8, 7),
            ('x',): shape=(1, 8, 5),
            ('y',): shape=(1, 8, 3, 2),
            ('z',): shape=(1, 8),
        },
        batch_size=(1, 8))

ad[4] ==
    ArrayDict(
        fields={
            ('nested', 'a'): shape=(8, 4),
            ('nested', 'b'): shape=(8, 2, 3),
            ('tuple', 'key'): shape=(8, 7),
            ('x',): shape=(8, 5),
            ('y',): shape=(8, 3, 2),
            ('z',): shape=(8,),
        },
        batch_size=(8,))

====================================================================================================
Test Log Generated Successfully
====================================================================================================